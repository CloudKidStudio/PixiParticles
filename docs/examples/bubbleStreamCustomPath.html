<!DOCTYPE html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>Bubble Stream (path following)</title>
		<meta name="description" content="bubble stream">
		<link rel="stylesheet" href="css/main.css">

		<!-- Required dependencies -->
		<script src="libs/pixi.js/dist/pixi.js"></script>
		<script src="../dist/pixi-particles.js"></script>

		<!-- Example scaffolding -->
		<script src="js/ParticleExample.js"></script>

	</head>
	<body>
		<div id="framerate"></div>
		<div id="instructions">Click Anywhere</div>
		<canvas id="stage" width="400" height="400"></canvas>
		<script>

			// See js/ParticleExample.js for actual setup
			new ParticleExample(
				// The image to use
				["images/Bubbles99.png"],

				// Emitter configuration, edit this to change the look
				// of the emitter
				{
					"alpha": {
						"start": 1,
						"end": 0.16
					},
					"scale": {
						"start": 0.3,
						"end": 0.4,
						"minimumScaleMultiplier":0.5
					},
					"color": {
						"start": "ffffff",
						"end": "ffffff"
					},
					"speed": {
						"start": 150,
						"end": 100
					},
					"startRotation": {
						"min": 270,
						"max": 270
					},
					"rotationSpeed": {
						"min": 0,
						"max": 20
					},
					"lifetime": {
						"min": 1.8,
						"max": 2
					},
					"blendMode": "normal",
					"frequency": 0.1,
					"emitterLifetime": 0,
					"maxParticles": 500,
					"pos": {
						"x": 0,
						"y": 0
					},
					"addAtBack": false,
					"spawnType": "point",
					"extraData":
					{
						"path": function (x) { return x; }
					}
				},
				//tell the particle example to use PIXI.particles.PathParticle
				"path");

			var canvas = document.getElementById("stage");
			canvas.addEventListener('mouseup', function(e){
				if(!(window.emitter && window.emitter.pathFunction)) return;
				
				// on each click, select a random path function.
				var randInt = Math.floor(Math.random() * pathsArray.length);
				window.emitter.pathFunction = pathsArray[randInt];
			});

			var pathsArray = [easing_bounceIn, easing_bounceOut, easing_quarticOut];

			function easing_bounceIn(k)	{ return 1 - easing_bounceOut(1- k);	}
			function easing_bounceOut(k)
			{
				k /= 30;
				if (k < (1 / 2.75)) {
				    return 7.5625 * k * k;
				} else if (k < (2 / 2.75)) {
				    return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;
				} else if (k < (2.5 / 2.75)) {
				    return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;
				} else {
				    return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;
				}
			}
			function easing_quarticOut(k) {	k /= 30; return 1 - (--k * k * k * k); }
		</script>
	</body>
</html>